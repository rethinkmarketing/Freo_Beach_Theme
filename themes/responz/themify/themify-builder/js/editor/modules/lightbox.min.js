((u,b,r,h,_)=>{"use strict";u.LightBox={storageKey:"visual"===u.mode?"themify_builder_lightbox_frontend_pos_size":"themify_builder_lightbox_backend_pos_size",size:null,isStandalone:!1,el:null,init(){r.document.body.appendChild(h.tfId("tmpl-builder_lightbox").content),this.el=r.document.tfId("tb_lightbox_parent"),this.firstRun(),u.Forms.initValidators()},firstRun(){if(b.on("tb_opened_lightbox",()=>{this.el.tfClass("tb_close_lightbox")[0].tfOn(b.click,()=>{this.close()},{passive:!0}),this.el.tfClass("builder_cancel_docked_mode")[0].tfOn(b.click,t=>{t.preventDefault(),t.stopPropagation(),u.Dock.close(!1),this.updateStorage(),u.MainPanel.updateStorage()}),!1===this.isStandalone&&(this.updateStorage(),this.setupLightboxSizeClass()),setTimeout(()=>{this.draggable(),this.resize()},250)},!0),!themifyBuilder.disableShortcuts){const t=t=>{const e=r.document.activeElement;"INPUT"===e.tagName||"TEXTAREA"===e.tagName||r.document.fullscreenElement||"true"===e.contentEditable||("Escape"===t.code&&u.activeModel?(t.preventDefault(),t.stopPropagation(),this.save().then(()=>{this.close()})):"KeyS"!==t.code||!0!==t.ctrlKey&&!0!==t.metaKey||(t.preventDefault(),t.stopPropagation(),(u.activeModel?this:u.Builder.get()).save()))};h.tfOn("keydown",t),"visual"===u.mode&&r.document.tfOn("keydown",t)}},open(d,e){return new Promise(c=>{const t=t=>{this.el.classList.add("tf_hide");const e=this.el.querySelector("#tb_lightbox_container"),i=this.el.tfClass("tb_lightbox_actions_wrap")[0],s=h.createElement("button");if("string"==typeof t)e.innerHTML=t;else{while(null!==e.firstChild)e.lastChild.remove();e.appendChild(t)}while(null!==i.firstChild)i.lastChild.remove();if(!1!==d.save){if(s.className="builder_button builder_save_button",s.title=themifyBuilder.i18n.label.ctr_save,s.textContent=themifyBuilder.i18n.label.done,u.activeModel){u.isDocked&&this.el.classList.add("tb_lightbox_small"),"visual"===u.mode&&(null!==u.GS.activeGS?(u.liveStylingInstance=u.createStyleInstance(),u.liveStylingInstance.init(null,!0)):(u.liveStylingInstance||(u.liveStylingInstance=u.createStyleInstance()),u.liveStylingInstance.init()));const l=t=>{t.stopImmediatePropagation(),this.save().then(()=>{!0!==u.isGSPage&&(s.tfOff(t.type,l,{passive:!0}),n.tfOff(t.type,l,{passive:!0}))}).catch(t=>{console.log(t)})},n=h.createElement("a"),a=h.createElement("li"),o=h.createElement("span");a.className="tb_top_save_btn",n.className="tb_tooltip",n.href="javascript:;",o.textContent=themifyBuilder.i18n.label.done,n.append(u.Helper.getIcon("ti-check"),o),a.appendChild(n),this.el.tfClass("tb_options_tab")[0].appendChild(a),s.tfOn(b.click,l,{passive:!0}),n.tfOn(b.click,l,{passive:!0}),u.undoManager.start("saveLightbox",u.activeModel)}i.appendChild(s)}if("html"===d.loadMethod&&!0!==d.contructor){const r=e.tfClass("tb_tab_nav");for(let t=r.length-1;-1<t;--t){let e=r[t].tfTag("a");for(let t=e.length-1;-1<t;--t)e[t].tfOn(b.click,ThemifyConstructor.switchTabs)}}this.el.classList.remove("tf_hide"),e.style.scrollBehavior="auto",e.scrollTop=0,e.style.scrollBehavior="",this.responsiveTabs(),b.trigger("tb_opened_lightbox"),u.Spinner.showLoader("spinhide"),u.SmallPanel.hide(),c(this.el)};this.close(),e&&(u.activeModel=e);try{"html"===d.loadMethod?!0===d.contructor?t(ThemifyConstructor.run(d.data)):t(d.data):t(ThemifyConstructor.run(u.FormTemplates.getItem(d)))}catch(t){console.log(t)}})},close(){return this.el.classList.contains("tf_hide")||!0===u.isGSPage||(b.trigger("themify_builder_lightbox_before_close",this.el),this.el.classList.add("tf_hide"),this.cleanLightBoxContent(),u.undoManager.updateUndoBtns(),u.Utils.removeViewPortClass(this.el),b.trigger("themify_builder_lightbox_close",this.el),"visual"===u.mode&&r.Themify.trigger("themify_builder_lightbox_close",this.el),null!==u.activeModel&&("visual"===u.mode&&u.liveStylingInstance.clear(),!0===u.activeModel.is_new?u.activeModel.destroy(!0):!u.activeModel.is_Saved&&u.undoManager.has("saveLightbox")&&u.activeModel.restore(),u.activeModel.is_Saved||u.undoManager.clear("saveLightbox"),u.activeModel=null)),this},setStandAlone(a,o){return b.on("tb_opened_lightbox",()=>{this.isStandalone=!0,r.document.body.classList.add("tb_standalone_lightbox"),this.el.style.width=this.el.style.height="";const t=u.ToolBar.el.getBoundingClientRect(),e=getComputedStyle(this.el),i=parseInt(e.width),s=parseInt(e.height),l=r.innerWidth-10,n=r.innerHeight+10;o<t.bottom?o=t.bottom:n<o+s&&(o-=o+s-n),a<0?a=0:l<a+i&&(a-=a+i-l),this.el.style.transform="translate("+a+"px,"+o+"px)",this.el.style.width=i+"px",this.el.style.height=s+"px",this.setupLightboxSizeClass(i),b.on("themify_builder_lightbox_close",t=>{r.document.body.classList.remove("tb_standalone_lightbox"),t.style.transform=t.style.width=t.style.height="",this.isStandalone=!1,this.updateStorage(),this.setupLightboxSizeClass(this.getStorage().w)},!0)},!0),this},cleanLightBoxContent(){const e=this.el.querySelectorAll("#tb_lightbox_container,.tb_options_tab,.tb_lightbox_actions_wrap,.tb_action_breadcrumb");for(let t=e.length-1;-1<t;--t)while(null!==e[t].firstChild)e[t].lastChild.remove();return this},async save(){const i=u.activeModel;if(!this.el.classList.contains("tf_hide")){if(null!==i){if(!0!==u.isGSPage&&!u.Forms.isValidate(this.el.querySelector("#tb_options_setting")))throw"invalid";ThemifyConstructor.setStylingValues(u.activeBreakPoint);let t=i.get("mod_settings"),e=u.Helper.cloneObject(ThemifyConstructor.values);const s=u.Forms.serialize("tb_options_setting",!0);for(let t in s)e[t]=s[t];if("column"!==i.type){const n=u.Forms.serialize("tb_options_animation",!0),a=u.Forms.serialize("tb_options_visibility",!0);for(let t in n)e[t]=n[t];for(let t in a)e[t]=a[t];if("visual"===u.mode){const o="hide_all"===a.visibility_all||"hide"===a.visibility_desktop||"hide"===a.visibility_tablet||"hide"===a.visibility_tablet_landscape||"hide"===a.visibility_mobile;i.el.classList.toggle("tb_visibility_hidden",o)}"module"===i.type&&u.Builder.get().removeLayoutButton()}u.ActionBar.id===i.id&&u.ActionBar.clear(),e=u.Helper.clear(e,!1),t=u.Helper.clear(t,!1);const l=u.Helper.compareObject(t,e);!0===l&&(b.trigger("themify_builder_save_component",[e,t]),"visual"===u.mode&&r.Themify.trigger("themify_builder_save_component",[e,t]),i.set("mod_settings",e)),i.is_new=!1,i.is_Saved=!0,this.close(),!0!==u.isGSPage&&!0===l?u.undoManager.end("saveLightbox"):u.undoManager.clear("saveLightbox"),delete i.is_new,delete i.is_Saved}else r.document.body.classList.contains("tb_standalone_lightbox")&&await b.trigger("tb_save_lb");!0===u.isGSPage&&await TF_Notification.showHide("done",themifyBuilder.globalStyleData.save_text,2e3)}},resize(){const _=this,e=this.el.tfClass("tb_resizable");for(let t=e.length-1;-1<t;--t)e[t].tfOn("pointerdown",function(t){if(1===t.which){t.stopImmediatePropagation();let e=this.ownerDocument,a=_.el,i;a.style.willChange="transform,width,height";const o=350,r=880,c=.9*e.documentElement.clientHeight,d=parseInt(getComputedStyle(a).getPropertyValue("min-height")),h=this.dataset.axis,p=parseInt(a.offsetHeight,10),f=parseInt(a.offsetWidth,10),g=t.clientX,u=t.clientY,s=()=>{e.body.classList.add("tb_start_animate")},l=n=>{n.stopImmediatePropagation(),i=requestAnimationFrame(()=>{let t;const e=n.clientX,i=n.clientY,s=new DOMMatrix(getComputedStyle(a).transform);if("w"===h)(t=(t=g+f-e)>r?r:t)>=o&&t<=r&&(s.m41+=parseInt(a.style.width)-t,a.style.width=t+"px",_.setupLightboxSizeClass(t));else{const l="-y"===h||"ne"===h||"nw"===h?u+p-i:p+i-u;(t="sw"===h||"nw"===h?g+f-e:f+e-g)>r&&(t=r),("se"===h||"x"===h||"sw"===h||"nw"===h||"ne"===h)&&t>=o&&t<=r&&("sw"!==h&&"nw"!==h||(s.m41+=parseInt(a.style.width)-t),a.style.width=t+"px",_.setupLightboxSizeClass(t)),("se"===h||"y"===h||"-y"===h||"sw"===h||"nw"===h||"ne"===h)&&l>=d&&l<=c&&("-y"!==h&&"nw"!==h&&"ne"!==h||(s.m42+=parseInt(a.style.height)-l),a.style.height=l+"px")}a.style.transform="translate("+s.m41+"px,"+s.m42+"px)",b.trigger("tb_resize_lightbox")})},n=function(t){t.stopImmediatePropagation(),i&&cancelAnimationFrame(i),this.tfOff("pointermove",s,{passive:!0,once:!0}).tfOff("pointermove",l,{passive:!0}).tfOff("lostpointercapture pointerup",n,{passive:!0,once:!0}),a.style.willChange="",_.updateStorage(),e.body.classList.remove("tb_start_animate"),e=a=i=null};this.tfOn("lostpointercapture pointerup",n,{passive:!0,once:!0}).tfOn("pointermove",s,{passive:!0,once:!0}).tfOn("pointermove",l,{passive:!0}).setPointerCapture(t.pointerId)}},{passive:!0})},draggable(){const f=this,e=this.el.querySelectorAll(".tb_lightbox_top_bar,.tb_action_breadcrumb");for(let t=e.length-1;-1<t;--t)e[t].tfOn("pointerdown",function(t){if(1===t.which){const e=t.target.classList;if(e.contains("tb_lightbox_top_bar")||e.contains("tb_action_breadcrumb")){t.stopImmediatePropagation();let e,n=f.el,i=this.ownerDocument;n.style.willChange="transform";const s=t.clientX,l=t.clientY,a=n.getBoundingClientRect(),o=a.left-s,r=a.top-l,c=a.width,d=l=>{l.stopImmediatePropagation(),e=requestAnimationFrame(()=>{const t=l.clientX,e=l.clientY,i=o+t,s=r+e;n.style.transform="translate("+i+"px,"+s+"px)",b.trigger("tb_panel_drag",[i,c])})},h=t=>{t.stopImmediatePropagation(),i.body.classList.add("tb_start_animate","tb_drag_lightbox"),u.ToolBar.el.classList.add("tb_start_animate","tb_drag_lightbox"),u.MainPanel.el.classList.add("tb_start_animate","tb_drag_lightbox"),b.trigger("tb_panel_drag_start"),!1===this.isStandalone&&this.setupLightboxSizeClass()},p=function(t){t.stopImmediatePropagation(),e&&cancelAnimationFrame(e),this.tfOff("pointermove",h,{passive:!0,once:!0}).tfOff("pointermove",d,{passive:!0}).tfOff("lostpointercapture pointerup",p,{passive:!0,once:!0}),n.style.willChange="",b.trigger("tb_panel_drag_end"),!1===f.isStandalone&&(f.updateStorage(),f.setupLightboxSizeClass()),i.body.classList.remove("tb_start_animate","tb_drag_lightbox"),u.ToolBar.el.classList.remove("tb_start_animate","tb_drag_lightbox"),u.MainPanel.el.classList.remove("tb_start_animate","tb_drag_lightbox"),e=n=i=null};this.tfOn("lostpointercapture pointerup",p,{passive:!0,once:!0}).tfOn("pointermove",h,{passive:!0,once:!0}).tfOn("pointermove",d,{passive:!0}).setPointerCapture(t.pointerId)}}},{passive:!0})},responsiveTabs(){let s=null,l=0,n=null,t=()=>{const t=()=>{if(null===s&&null!==(s=this.el.querySelector(".tb_styling_tab_nav ul"))){const t=s.lastElementChild;l=t.offsetLeft+t.offsetWidth}if(null!==s&&0!==l){u.isDocked?s.style.display="none":s.style.flexDirection="row";const e=s.parentNode.offsetWidth;if(e<=l||u.isDocked){s.style.display="none";const i=s.tfClass("current")[0];null===n&&((n=h.createElement("span")).className="tb_ui_dropdown_label",n.tabIndex="-1",s.before(n)),i&&(n.textContent=i.textContent),setTimeout(()=>{s.style.display=""},100)}else null!==n&&(n.remove(),n=null);return!(s.style.flexDirection="")}if(u.isDocked)return!1};u.isDocked&&t()||setTimeout(t,0)};t(),b.on("tb_builder_tabsactive",t).on("tb_resize_lightbox",t).on("themify_builder_lightbox_close",()=>{b.off("tb_builder_tabsactive",t).off("tb_resize_lightbox",t),s=l=n=t=null},!0)},setupLightboxSizeClass(t){t=t||(u.isDocked?parseInt(getComputedStyle(this.el).width):this.getStorage().width||parseInt(this.el.offsetWidth));const e=this.el.classList;e.toggle("larger-lightbox",750<t),e.toggle("tb_lightbox_small",t<540)},getStorage(){if(null===this.size){let t=localStorage.getItem(this.storageKey);t=t?JSON.parse(t):{};const e={top:100,left:Math.max(0,r.innerWidth/2-300),width:600,height:500};this.size=Object.assign(e,t)}return this.size},updateStorage(){if(!1===this.isStandalone){const e=this.el.style.transform,i=e?new DOMMatrix(e):null,s=this.el.tfClass("tb_lightbox_top_bar")[0].getBoundingClientRect(),l=r.innerHeight-s.height,n=r.innerWidth,a=this.getStorage();let t={width:this.el.style.width,height:this.el.style.height};return i&&(t.top=i.m42,t.left=i.m41),t.height<=0?delete t.height:t.height=parseInt(t.height),t.width<=0?delete t.width:t.width=parseInt(t.width),((t=Object.assign({},a,t)).left<0||t.left+s.width>n)&&(t.left=t.left<0?0:n-s.width),(t.top<0||t.top>l)&&(t.top=t.top<0?0:l),this.el.style.transform="translate("+t.left+"px,"+t.top+"px)",this.el.style.width=t.width+"px",this.el.style.height=t.height+"px",u.isDocked||a===t||Object.entries(t).toString()===Object.entries(a).toString()||(this.size=null,localStorage.setItem(this.storageKey,JSON.stringify(t))),t}}},u.LiteLightBox={el:null,open(t){const e=h.createElement("form"),i=h.createElement("span");if(!this.el){const s=h.tfId("tb_lite_lightbox_root"),l=s.firstElementChild,n=u.ToolBar.el.getRootNode(),a=n.querySelector("#tf_base");l&&(s.attachShadow({mode:l.getAttribute("shadowroot")}).appendChild(l.content),l.remove()),s.shadowRoot.prepend(a.cloneNode(!0)),this.el=s.shadowRoot.tfId("wrapper"),r.document.body.appendChild(s),this.el.tfOn(b.click,t=>{this.el===t.target&&this.close(t)})}e.className="content tf_abs_c tf_textc tf_box",i.tfOn(b.click,t=>{this.close(t)},{once:!0}).className="tf_close",e.append(t,i),this.el.appendChild(e),this.el.getRootNode().host.classList.remove("tf_hide")},close(t){this.el&&(t&&(t.stopPropagation(),t.preventDefault()),u.Registry.trigger(this.el,"close"))},create(l){const e=h.createDocumentFragment();for(let s in l)if("buttons"===s){let i=h.createElement("div");i.className="btns";for(let e in l[s]){let t=h.createElement("button");t.className="tf_inline_b tf_textc",t.dataset.type=e,t.tfOn(b.click,t=>{this.buttonClick(t)}).innerText=l[s][e],i.appendChild(t)}e.appendChild(i)}else if("msg"===s){let t=h.createElement("div");t.className="msg",t.innerHTML=l[s],e.appendChild(t)}else if("input"===s){let t=h.createElement("input");t.className=l[s].class+" tf_w",t.value=l[s].value||"",t.tfOn("keydown",t=>{this.keyPress(t)},{passive:!0}).type=l[s].type,setTimeout(()=>{t.focus()},100),e.appendChild(t)}return e},confirm(t){return t.buttons||(t.buttons={no:ThemifyConstructor.label.no,yes:ThemifyConstructor.label.y}),this.open(this.create(t)),new Promise(i=>{u.Registry.on(this.el,"confirm",t=>{let e=this.el.querySelector(".content").tfTag("input")[0];e?(e=e.value||"",i([t,e])):i(t)}).on(this.el,"close",()=>{i(null)})}).finally(()=>{u.Registry.off(this.el,"confirm").off(this.el,"close").remove(this.el),this.el.getRootNode().host.classList.add("tf_hide"),this.el.innerHTML=""})},alert(t){return this.confirm({msg:t,buttons:{yes:ThemifyConstructor.label.ok}})},prompt(t,e){return this.confirm({msg:t,input:{type:"text",class:"prompt_input",value:e},buttons:{no:ThemifyConstructor.label.cancel,yes:ThemifyConstructor.label.ok}})},buttonClick(t){t.preventDefault(),t.stopPropagation();const e=t.currentTarget.dataset.type;"cancel"===e?this.close():u.Registry.trigger(this.el,"confirm",e)},keyPress(t){"Enter"===t.code&&u.Registry.trigger(this.el,"confirm","yes",t.currentTarget.value.trim())}},u.Forms={validators:new Map,parseSettings(s,t){const e=s.classList,i=t?s.dataset.inputId:s.id;if(!i)return!1;if(!e.contains("tb_row_js_wrapper")){let t=s.closest(".tb_field");if(!(null===t||t.classList.contains("_tb_hide_binding")||"none"===t.style.display&&t.className.includes("tb_group_element_"))&&(t=t.parentNode).classList.contains("tb_multi_fields")&&t.parentNode.classList.contains("_tb_hide_binding"))return!1}let n="";if(e.contains("tb_lb_wp_editor"))if("undefined"!=typeof tinyMCE){const l=s.id,a=tinyMCE.get(l);n=null!==a?!1===a.hidden?a.getContent():switchEditors.wpautop(tinymce.DOM.get(l).value):s.value}else n=s.value;else if(e.contains("tb_checkbox_wrap")){const o=[],r=s.tfClass("tb_checkbox"),c=e.contains("tb_switcher");for(let t=0,e=r.length;t<e;++t)!0!==c&&!0!==r[t].checked||""===r[t].value||o.push(r[t].value);n=0<o.length?o.join("|"):!!c&&""}else if(e.contains("themify-layout-icon"))n=(n=s.tfClass("selected")[0])!==_?n.id:"";else if(e.contains("tb_search_input")){n=s.dataset.value;let t=s.closest(".tb_input"),e=t.tfClass("query_category_multiple")[0];e&&(""!==(e=e===_?"":e.value.trim())?n=e+"|"+(e.includes(",")?"multiple":"single"):n+="|single")}else if(e.contains("tb_radio_wrap")){const d=s.tfTag("input");let e=null;for(let t=d.length-1;-1<t;--t)if(!0===d[t].checked){e=d[t];break}null===e||"desktop"!==u.activeBreakPoint&&e.classList.contains("tb_responsive_disable")||(n=e.value)}else if(e.contains("tb_search_container"))n=s.previousElementSibling.dataset.value;else if(e.contains("tb_row_js_wrapper")){n=[];const h=s.tfClass("tb_repeatable_field_content");for(let s=0,t=h.length;s<t;++s){let i=h[s].tfClass("tb_lb_option_child");n[s]={};for(let e=0,t=i.length;e<t;++e){let t=this.parseSettings(i[e],!0);t&&t.id&&(n[s][t.id]=t.v)}}}else if(e.contains("module-widget-form-container"))n=this.themifySerializeObject(s);else if(e.contains("tb_widget_select"))n=(n=s.tfClass("selected")[0])!==_?n.dataset.value:"";else if(e.contains("tb_sort_fields_parent")){const p=s.children;n=[];for(let i=0,t=p.length;i<t;++i){let e=p[i].dataset.type;if(e){let t=p[i].tfClass("tb_sort_field_dropdown")[0],s={type:e,id:p[i].dataset.id};if(t!==_){s.val={};let i=t.tfClass("tb_lb_sort_child");for(let e=i.length-1;-1<e;--e){let t=this.parseSettings(i[e],!0);t&&t.id&&(s.val[t.id]=t.v)}}else{let t=p[i].tfTag("input")[0],e=t.value;""!==e&&(s.val=JSON.parse(e))}n.push(s)}}0===n.length&&(n="")}else if(e.contains("tb_accordion_fields")){const f=s.children;n={};for(let l=0,t=f.length;l<t;++l){let s=f[l].dataset.id;if(s){let e=f[l].tfTag("input")[0],t=f[l].tfClass("tb_accordion_fields_options")[0],i={};if(t!==_)i.val=this.serialize(t,null,!0);else{let t=e.value;""!==t&&(i.val=JSON.parse(t))}n[s]=i}}}else if(e.contains("tb_toggleable_fields")){const g=s.children;n={};for(let l=0,t=g.length;l<t;++l){let s=g[l].dataset.id;if(s){let e=g[l].tfTag("input")[0],t=g[l].tfClass("tb_toggleable_fields_options")[0],i={on:g[l].tfClass("tb_switcher")[0].tfClass("toggle_switch")[0].value};if(t!==_)i.val=this.serialize(t,null,!0);else{let t=e.value;""!==t&&(i.val=JSON.parse(t))}n[s]=i}}}else if("SELECT"===s.nodeName&&s.multiple){n=[];for(let t=s.selectedOptions,e=0,i=t.length;e<i;++e)n.push(s.selectedOptions[e].value)}else if(n=s.value,window.tbpDynamic!==_&&i===tbpDynamic.field_name){if(""===n)return!1;"string"==typeof n&&(n=JSON.parse(n))}else{if(i===u.GS.key&&"desktop"!==u.activeBreakPoint)return!1;if(""!==n)if("builder_content"===i)"string"==typeof n&&(n=JSON.parse(n));else{if("string"==typeof n&&n.includes(":")&&n.includes("{"))try{let t=JSON.parse(n);n=t}catch(t){}let t=s.dataset.opacity;null!==t&&""!==t&&(t=parseFloat(parseFloat(Number(t).toFixed(2)).toString()))<.99&&(n+="_"+t)}}return{id:i,v:n=n!==_&&null!==n?n:""}},serialize(t,i,s){const l={},e="object"==typeof t?t:u.LightBox.el.querySelector("#"+t);if(s=s||!1,null!==e){const n=e.tfClass(s?"tb_lb_option_child":"tb_lb_option");for(let e=n.length-1;-1<e;--e){let t=this.parseSettings(n[e],s);!1===t||!t.id||!0!==i&&""===t.v||(l[t.id]=t.v)}}return l},initValidators(){this.registerValidator("email",t=>{const e="string"==typeof t?t:t.value.split(","),i=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;for(let t=e.length-1;-1<t;--t)if(!i.test(e[t]))return!1;return!0}),this.registerValidator("row_anchor",t=>{let e=t.value;return e=e&&e.replaceAll("#","").replaceAll(" ","").trim(),t.value=e,!0}),this.registerValidator("custom_css_id",t=>{let e=0,i=t.value.trim();if(i){i=i.replace(/[^a-zA-Z0-9\-\_]/g,"");while(1){if(isNaN(i[0]))break;i=i.substring(1)}if(i){const s=h.querySelectorAll("#"+i);if(1<s.length)for(let t=s.length-1;-1<t;--t)null!==s[t].closest(".module_row")&&++e}}return t.value=i,e<=1}),this.registerValidator("custom_css",t=>{let e=t.value;if(e){for(let t=(e=e.replace(/\s\s+/g," ").split(" ")).length-1;-1<t;--t)if(e[t]=e[t].replace(/[^a-zA-Z0-9\s\-\_]/g,""),""!==e[t][0])while(1){if(isNaN(e[t][0]))break;e[t]=e[t].substring(1)}e=e.join(" ")}return t.value=e,!0}),this.registerValidator("not_empty",t=>""!==t.value.toString().trim())},registerValidator(t,e){this.validators.set(t,e)},getValidator(t){return this.validators.get(t)||this.validators.get("not_empty")},isValidate(t){const n=t.tfClass("tb_must_validate"),e=n.length,a=(t,e)=>{const i=this.getValidator(t);return i(e)};if(0===e)return!0;let o=!0;for(let l=e-1;-1<l;--l){let i=n[l].tfClass("tb_lb_option")[0],s=a(n[l].dataset.validation,i);if(!0!==s){if(!i.classList.contains("tb_field_error")){let t=h.createElement("span"),e="SELECT"===i.tagName?i.parentNode:i;t.className="tb_field_error_msg",t.textContent=!1===s?n[l].dataset.errorMsg:s,i.classList.add("tb_field_error"),e.parentNode.insertBefore(t,e.nextSibling)}o=!1}else{i.classList.remove("tb_field_error");let e=n[l].tfClass("tb_field_error_msg");for(let t=e.length-1;-1<t;--t)e[t].remove()}}if(!1===o){const i=u.LightBox.el.querySelector('a[data-id="'+t.id+'"]');i.parentNode.classList.contains("current")||b.triggerEvent(i,b.click),TF_Notification.showHide("error",themifyBuilder.i18n.lightBoxRequiredFields)}return o},themifySerializeObject(t){const n={},a=t.querySelectorAll("input,select,textarea");for(let l=a.length-1;-1<l;--l){let t=a[l].tagName,e=a[l].type,i=a[l].value,s=a[l].name||a[l].id;if(s&&"button"!==e&&"submit"!==e&&""!==i){if(a[l].classList.contains("wp-editor-area")&&"undefined"!=typeof tinyMCE){let t=tinyMCE.get(a[l].id);t&&(i=t.getContent().trim())}else if("radio"===e||"checkbox"===e||"select"===t)if("select"===t){if(a[l].hasAttribute("multiple")){let s=[];for(let t=0,e=a[l].children,i=e.length;t<i;++t)e[t].selected&&s.push(e[t].value);i=s}}else if(!a[l].checked)continue;""!==i&&("checkbox"===e?(n[s]===_&&(n[s]=[]),n[s].push(i)):n[s]=i)}}return n}},u.LightBox.init()})(tb_app,Themify,window.top,document,void 0);