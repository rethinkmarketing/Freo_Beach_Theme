((w,y,S)=>{"use strict";let L=!1;const N=new IntersectionObserver((a,e)=>{for(let s=a.length-1;-1<s;--s){let e=a[s].target.id,t=y.querySelectorAll('.module-toc a[href="#'+CSS.escape(encodeURI(e))+'"]'),l=!0===a[s].isIntersecting;for(let e=t.length-1;-1<e;--e)t[e].parentNode.classList.toggle("tb_toc_active",l)}},{threshold:[0,1]}),l=t=>{if(tbLocalScript){const l=tbLocalScript.breakpoints;let e="desktop";return t<=l.mobile?e="mobile":t<=l.tablet[1]?e="tablet":t<=l.tablet_landscape[1]&&(e="tablet_landscape"),e}},A=e=>{let t=e.dataset.bp;return!(!t||"n"===t)&&(t="tl"===t?"tablet_landscape":"t"===t?"tablet":"mobile",t=tbLocalScript.breakpoints[t],(t=Array.isArray(t)?t[1]:t)>=w.w)},q=e=>{let t=e.target?e.target.closest(".tf_fa,a"):null;if(t)if("A"===t.tagName){const a=t.getAttribute("href").replace("#",""),i=y.querySelector("#"+CSS.escape(decodeURI(a))+".tb_toc_el");i&&(e.preventDefault(),!1===w.is_builder_active)&&requestAnimationFrame(()=>{w.lazyScroll(w.convert(w.selectWithParent("[data-lazy]",i.closest(".module_row"))).reverse(),!0).finally(()=>{const l=i.getBoundingClientRect(),s=window.scrollY;w.scrollTo(l.top+s-10,null,()=>{let e=y.tfId("headerwrap"),t=10;e&&e.classList.contains("fixed-header")&&(t+=e.getBoundingClientRect().bottom),w.scrollTo(l.top+s-t),window.location.hash=a})})})}else if(t=t.closest(".tb_toc_head,.tb_toc_cic_close,.tb_toc_cic")){const l=t.parentNode,s=l.tfTag("ul")[0],o="0px"===getComputedStyle(s).getPropertyValue("max-height"),c=t.classList.contains("tb_toc_head")?"tb_tc_close":"tb_tc_sub_close",n=s.style,r=(n.maxHeight="none",s.clientHeight),d=o?r:0,h=o?0:r;n.maxHeight=h+"px",s.tfOn("transitionend",e=>{l.classList.toggle(c,!o),0<d&&(n.maxHeight=""),n.padding=0<d?"":"0px"},{passive:!0,once:!0}),requestAnimationFrame(()=>{n.maxHeight=d+"px",n.padding=0<d?"":"0px"})}};let a=l(w.w);w.on("builder_load_module_partial tb_toc",(e,t)=>{if(!0!==t||e.classList.contains("module-toc")){const l=w.selectWithParent("module-toc",e);for(let e=l.length-1;-1<e;--e)(c=>{let l=c.dataset.tags,a=c.dataset.excl,e=c.dataset.cont||"b",s=c.dataset.sel;if(l){let t;if("cust"===e){if(s){const h=(s=s.trim()).slice(-1);if(s=","!==h&&"."!==h&&"#"!==h?s:s.slice(0,-1))try{t=y.querySelectorAll(s)}catch(e){}}}else{if("b"===e||"b_c"===e){if(t=c.closest(".themify_builder"),"b_c"===e){let e=t;while(1)if(null===(e=e.parentNode.closest(".themify_builder")))break;null===e&&(e=t.parentNode);while(null!==e&&null===e.nextElementSibling&&null===e.previousElementSibling)e=e.parentNode;null!==e&&(t=e)}}else"r"===e||"c"===e?(t=c.closest(".module_column"),"r"===e&&(t=t.closest(".module_row"))):"doc"===e&&(t=y);t=t&&[t]}if(t&&0<t.length){l=l.replace(/\|/g,",");let e="#comments,.tf_carousel,.loops-wrapper,.module-accordion,.widget-title,.module-tab,.module-toc,.module-gallery,.module-image,.nav,.module-service-menu";c.dataset.ex_m&&(e+=",.module-title");const p=new Set,_=[],f=c.tfClass("tpl_toc_ic")[0],m=c.tfClass("tpl_toc_cic")[0],u=c.tfClass("tpl_toc_cic_close")[0],g=1<c.dataset.min?parseInt(c.dataset.min):2,b=parseInt(c.dataset.maxh)||32,v=parseInt(c.dataset.maxt)||0,C=(s,a)=>{const i=y.createDocumentFragment(),e=y.createElement("ul");e.className="tb_toc_lv_"+a+" tf_w tf_box",1===a&&A(c)&&(e.style.maxHeight="0",c.classList.add("tb_tc_close"));for(var o=0,t=s.length;o<t;++o){let e=y.createElement("li"),t=y.createElement("a"),l=y.createDocumentFragment();t.href="#"+s[o].id,t.textContent=s[o].text,f!==S&&l.appendChild(f.content.cloneNode(!0)),l.appendChild(t),0<s[o].childs.length&&(++a,m!==S&&l.appendChild(m.content.cloneNode(!0)),u!==S&&l.appendChild(u.content.cloneNode(!0)),l.appendChild(C(s[o].childs,a))),e.appendChild(l),i.appendChild(e)}return e.appendChild(i),e};if(a){const x=(a=a.trim()).slice(-1);","!==x&&"."!==x&&"#"!==x||(a=a.slice(0,-1))}for(var i=0,o=t.length;i<o;++i){let s=t[i].querySelectorAll(l);for(var n=0,r=s.length;n<r;++n)if(!(p.has(s[n])||null!==s[n].closest(e)||a&&s[n].matches(a)&&s[n].closest(a))&&(p.add(s[n]),0<s[n].offsetWidth)&&0<s[n].offsetHeight&&0<s[n].getClientRects().length){let t=s[n].textContent.trim();if(t){0<v&&t.length>v&&(t=t.substr(0,v));let e=s[n].dataset.isSet?null:s[n].id,l=e||t.toLowerCase();if(l=l.replace(/(\r\n|\n|\r)/gm," ").replace(/[`â€™~!@#$%^&*()|+\=?;:'",.<>\{\}\[\]\\\/]/gi,"").replace(/\s\s+/gu," "),!e){if(!0===w.is_builder_active&&(s[n].dataset.isSet=!0),(l=l.replace(/\s/gu,"-")).length>b){if(1<(l=l.split("-")).length)for(var d=l.length-1;-1<d;--d)if(l.splice(d,1),1===d||l.join("-").length<=b)break;(l=l.join("-")).length>b&&(l=l.substring(0,b))}let e=2,t=l=!1===isNaN(l[0])?"tb-"+l:l;while(null!==y.tfId(l))l=t+"-"+e,++e}s[n].id=l,s[n].classList.add("tb_toc_el"),_.push({id:encodeURIComponent(l),text:t,h:+s[n].nodeName.replace("H",""),childs:[]}),!0!==w.is_builder_active&&N.observe(s[n])}}}if(p.clear(),_.length>g){if(c.classList.contains("tb_toc_tree")){for(i=1,o=_.length;i<o;++i)if(1!==_[i].h)if(_[i-1].h<_[i].h)_[i-1].childs.push(_[i]),_[i].delete=!0;else for(n=i-1;-1<n;--n)if(_[n].h<_[i].h){_[n].childs.push(_[i]),_[i].delete=!0;break}for(i=o-1;-1<i;--i)!0===_[i].delete&&_.splice(i,1)}requestAnimationFrame(()=>{const e=c.tfClass("tb_toc_lv_1")[0],t=!1===L?window.location.hash:"";if(L=!0,e&&e.remove(),c.appendChild(C(_,1)),c.tfOn("click",q).classList.remove("tf_hide"),!1===w.is_builder_active&&""!==t&&"#"!==t){const l=c.querySelector('a[href="#'+t.replace("#","")+'"]');l&&l.click()}})}else requestAnimationFrame(()=>{c.classList.add("tf_hide")})}}})(l[e])}}).on("infiniteloaded",()=>{w.trigger("tb_toc")}).on("tfsmartresize",t=>{requestAnimationFrame(()=>{const e=l(t.w);if(e!==a){a=e;const s=y.tfClass("tb_toc_lv_1");for(let l=s.length-1;-1<l;--l){let e=s[l].parentNode,t=A(e);s[l].style.maxHeight=t?"0":"",e.classList.toggle("tb_tc_close",t)}}})})})(Themify,document,void 0);